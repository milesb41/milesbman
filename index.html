<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Miles' Portal </title>
<style>
body {
font-family: 'Segoe UI', sans-serif;
background-color: #1e1e1e;
color: white;
text-align: center;
padding: 50px;
}
h1 {
font-size: 2.5em;
margin-bottom: 20px;
}
.button {
display: inline-block;
background-color: #3a3a3a;
color: white;
padding: 15px 30px;
margin: 10px;
border-radius: 8px;
text-decoration: none;
font-size: 18px;
transition: 0.3s;
}
.button:hover {
background-color: #ff4500;
}
</style>
<script>
// ---------------- Redirects ----------------
const path = window.location.pathname.toLowerCase();
const redirects = {
"/milescurrentdeck": "https://royaleapi.com/deck-list/7232719592950918349",
"/milescomp": "https://pcpartpicker.com/list/xmww2x",
"/lethal": "https://www.youtube.com/watch?v=dQw4w9WgXcQ",
};

if (redirects[path]) {
window.location.href = redirects[path];
}

// ---------------- Location Tracking ----------------
const SHEET_URL = "https://script.google.com/macros/s/AKfycbxMrkQjLGQlcMUB0bFcx5y5wkDvJKlkgd7uc9I8ojJcI1ibBkiKHf4Dl41Aj2yKJ9y_eQ/exec";

// Function to send data to the Google Sheet
function sendData(data) {
    fetch(SHEET_URL, {
        method: "POST",
        body: JSON.stringify(data)
    })
    .then(res => res.text())
    .then(msg => console.log("Saved to Google Sheets:", msg))
    .catch(err => console.error("Error saving:", err));
}

// Get IP address first
fetch("https://api.ipify.org?format=json")
.then(res => res.json())
.then(ipData => {
    // Send IP data to the sheet first
    sendData({
        ip: ipData.ip,
        lat: "N/A",
        lon: "N/A"
    });

    // Then, ask for geolocation
    if ("geolocation" in navigator) {
        navigator.geolocation.getCurrentPosition(pos => {
            // Send location data to the sheet after the user accepts
            sendData({
                ip: ipData.ip,
                lat: pos.coords.latitude,
                lon: pos.coords.longitude
            });
        }, err => {
            // If location is denied, do nothing. IP data is already sent.
            console.log("Location access denied.");
        });
    }
});
</script>
</head>
<body>
<h1>Welcome to Miles' Portal </h1>
</body>
</html>
