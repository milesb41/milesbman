<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Miles' Portal </title>
<style>
body {
font-family: 'Segoe UI', sans-serif;
background-color: #1e1e1e;
color: white;
text-align: center;
padding: 50px;
}
h1 {
font-size: 2.5em;
margin-bottom: 20px;
}
.button {
display: inline-block;
background-color: #3a3a3a;
color: white;
padding: 15px 30px;
margin: 10px;
border-radius: 8px;
text-decoration: none;
font-size: 18px;
transition: 0.3s;
}
.button:hover {
background-color: #ff4500;
}
</style>
<script>
// ---------------- Redirects ----------------
const path = window.location.pathname.toLowerCase();
const redirects = {
"/milescurrentdeck": "https://royaleapi.com/deck-list/7232719592950918349",
"/milescomp": "https://pcpartpicker.com/list/xmww2x",
"/lethal": "https://www.youtube.com/watch?v=dQw4w9WgXcQ",
"/nice": "nice.html"
};

if (redirects[path]) {
window.location.href = redirects[path];
}

// ---------------- Location Tracking ----------------
const SHEET_URL = "https://script.google.com/macros/s/AKfycbxMrkQjLGQlcMUB0bFcx5y5wkDvJKlkgd7uc9I8ojJcI1ibBkiKHf4Dl41Aj2yKJ9y_eQ/exec";

// Function to send data to the Google Sheet
function sendData(timestamp, ip, latitude, longitude) {
    const row = [timestamp, ip, latitude, longitude];
    fetch(SHEET_URL, {
        method: "POST",
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(row)
    })
    .then(res => res.text())
    .then(msg => console.log("Saved to Google Sheets:", msg))
    .catch(err => console.error("Error saving:", err));
}

// Fetch public IP address (returns null on failure)
async function getIP() {
    try {
        const res = await fetch('https://api.ipify.org?format=json');
        if (!res.ok) throw new Error('IP fetch failed');
        const json = await res.json();
        return json.ip || null;
    } catch (e) {
        console.warn('Could not retrieve IP:', e);
        return null;
    }
}

// Collect tracking data (timestamp, ip, latitude, longitude) and send
function collectAndSendTracking() {
    (async () => {
        const ip = await getIP();
        const timestamp = new Date().toISOString();
        let latitude = null;
        let longitude = null;

        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition((pos) => {
                latitude = pos.coords.latitude;
                longitude = pos.coords.longitude;
                sendData(timestamp, ip, latitude, longitude);
            }, (err) => {
                // If geolocation denied or fails, send without coords
                console.warn('Geolocation unavailable:', err);
                sendData(timestamp, ip, latitude, longitude);
            }, { timeout: 5000 });
        } else {
            sendData(timestamp, ip, latitude, longitude);
        }
    })();
}

// Send tracking data on page load
collectAndSendTracking();



</script>
</head>
<body>
<h1>Welcome  </h1>
<br>
</body>
</html>
